# Proposed JSON Structure Optimization

## Current Issues
1. Strategy-specific metrics are separated from their strategies
2. Risk metrics mix individual and combined metrics
3. Signal metrics could be more clearly attributed
4. Metric organization could be more intuitive

## Proposed Structure

```json
{
    "strategies": [
        {
            "id": "strategy_1",  // Added for clear reference
            "parameters": {
                "ticker": {
                    "value": "BTC-USD",
                    "description": "Ticker symbol to analyze"
                },
                "timeframe": {
                    "value": "Daily",
                    "description": "Trading timeframe (Hourly or Daily)"
                },
                "type": {
                    "value": "SMA",
                    "description": "Strategy type (MACD, SMA, or EMA)"
                },
                "direction": {
                    "value": "Long",
                    "description": "Trading direction (Long or Short)"
                },
                "short_window": {
                    "value": 12,
                    "description": "Period for short moving average or MACD fast line"
                },
                "long_window": {
                    "value": 21,
                    "description": "Period for long moving average or MACD slow line"
                }
            },
            "performance": {
                "expectancy_per_month": {
                    "value": 3522.31,
                    "description": "Expected monthly return"
                }
            },
            "risk_metrics": {
                "var_95": {
                    "value": -0.0517,
                    "description": "95% Value at Risk"
                },
                "cvar_95": {
                    "value": -0.0763,
                    "description": "95% Conditional Value at Risk"
                },
                "var_99": {
                    "value": -0.0956,
                    "description": "99% Value at Risk"
                },
                "cvar_99": {
                    "value": -0.1190,
                    "description": "99% Conditional Value at Risk"
                },
                "risk_contribution": {
                    "value": 0.4940,
                    "description": "Risk contribution to portfolio"
                },
                "alpha": {
                    "value": -0.0001,
                    "description": "Strategy alpha"
                }
            },
            "signals": {
                "count": {
                    "value": 228,  // Half of total signals assuming equal distribution
                    "description": "Number of signals generated by this strategy"
                }
            }
        }
    ],
    "portfolio_metrics": {
        "concurrency": {
            "total_concurrent_periods": {
                "value": 1612,
                "description": "Number of periods with concurrent positions"
            },
            "concurrency_ratio": {
                "value": 0.4237,
                "description": "Ratio of concurrent periods to total periods"
            },
            "exclusive_ratio": {
                "value": 0.2930,
                "description": "Ratio of periods with exactly one strategy in position"
            },
            "inactive_ratio": {
                "value": 0.2833,
                "description": "Ratio of periods with no active strategies"
            },
            "avg_concurrent_strategies": {
                "value": 1.5911,
                "description": "Average number of concurrent strategies"
            },
            "max_concurrent_strategies": {
                "value": 2,
                "description": "Maximum number of concurrent strategies"
            }
        },
        "efficiency": {
            "efficiency_score": {
                "value": 71.0541,
                "description": "Risk-Adjusted Performance"
            },
            "total_expectancy": {
                "value": 405.5837,
                "description": "Combined expected return across all strategies"
            },
            "multipliers": {
                "diversification": {
                    "value": 0.5978,
                    "description": "Multiplier effect from strategy diversification"
                },
                "independence": {
                    "value": 0.4089,
                    "description": "Multiplier effect from strategy independence"
                },
                "activity": {
                    "value": 0.7167,
                    "description": "Multiplier effect from strategy activity levels"
                }
            }
        },
        "risk": {
            "portfolio_metrics": {
                "risk_concentration_index": {
                    "value": 0.7956,
                    "description": "Measure of risk concentration"
                },
                "total_portfolio_risk": {
                    "value": 0.0285,
                    "description": "Total portfolio risk"
                },
                "benchmark_return": {
                    "value": 0.0036,
                    "description": "Benchmark return"
                }
            },
            "combined_risk": {
                "var_95": {
                    "value": -0.0516,
                    "description": "Combined 95% Value at Risk"
                },
                "cvar_95": {
                    "value": -0.0765,
                    "description": "Combined 95% Conditional Value at Risk"
                },
                "var_99": {
                    "value": -0.0956,
                    "description": "Combined 99% Value at Risk"
                },
                "cvar_99": {
                    "value": -0.1168,
                    "description": "Combined 99% Conditional Value at Risk"
                }
            },
            "strategy_relationships": {
                "risk_overlap_1_2": {
                    "value": 0.1434,
                    "description": "Risk overlap between strategies 1 and 2"
                }
            }
        },
        "signals": {
            "monthly_statistics": {
                "mean": {
                    "value": 4.0714,
                    "description": "Average number of signals per month"
                },
                "median": {
                    "value": 4.0000,
                    "description": "Median number of signals per month"
                },
                "std_below_mean": {
                    "value": 1.5089,
                    "description": "One standard deviation below mean signals"
                },
                "std_above_mean": {
                    "value": 6.6339,
                    "description": "One standard deviation above mean signals"
                },
                "volatility": {
                    "value": 2.5625,
                    "description": "Standard deviation of monthly signals"
                }
            },
            "summary": {
                "max_monthly": {
                    "value": 11.0000,
                    "description": "Maximum signals in any month"
                },
                "min_monthly": {
                    "value": 1.0000,
                    "description": "Minimum signals in any month"
                },
                "total": {
                    "value": 456.0000,
                    "description": "Total number of signals across period"
                }
            }
        }
    }
}
```

## Key Improvements

1. Strategy Organization
   - Added strategy IDs for clear reference
   - Grouped strategy parameters separately from metrics
   - Moved strategy-specific risk metrics into strategy objects
   - Added signal counts per strategy

2. Portfolio Metrics Organization
   - Renamed top-level "metrics" to "portfolio_metrics" for clarity
   - Better grouped related metrics (e.g., efficiency multipliers)
   - Separated combined risk metrics from individual strategy metrics
   - Created clear hierarchy for strategy relationships

3. Structural Improvements
   - More logical grouping of related metrics
   - Clearer separation between strategy-specific and portfolio-wide metrics
   - Better organized signal metrics with monthly statistics and summary
   - More consistent naming conventions

4. Benefits
   - Easier to understand relationship between metrics
   - Clearer attribution of metrics to specific strategies
   - More intuitive organization for analysis and reporting
   - Better scalability for adding new strategies or metrics

## Implementation Considerations

1. Migration
   - Need to update any code that reads/writes this JSON
   - Consider creating a migration script
   - Maintain backward compatibility during transition

2. Validation
   - Create JSON schema for new structure
   - Implement validation in code that generates this JSON
   - Add tests to ensure proper structure

3. Documentation
   - Update documentation to reflect new structure
   - Add examples of how to access common metrics
   - Document relationships between metrics